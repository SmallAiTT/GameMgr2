var ttUtils = require("tt-utils").ttUtils;
var CurdPo = require("../po/CurdPo");
var ctrlConst = require("../cfg/ctrlConst");
var curdUrl = ctrlConst.curd;
var gmClient = require("tt-db").gmClient;


module.exports = function(app){
    app.post(curdUrl.create, function(req, res){
        ttUtils.createPoByCtrl(req, res, gmClient, CurdPo);
    });
    app.post(curdUrl.update, function(req, res){
        var curd = ttUtils.transReq(req, CurdPo);
        gmClient.update(CurdPo, curd, {id : curd.id}, function(err, result){
            err ? ttUtils.doErr(res, err) : ttUtils.doInfo(res, null, result);
        });
    });
    app.post(curdUrl.read, function(req, res){
        gmClient.read(CurdPo, {id : req.body.id}, function(err, result){
            err ? ttUtils.doErr(res, err) : ttUtils.doInfo(res, null, result);
        });
    });
    app.post(curdUrl.del, function(req, res){
        gmClient.del(CurdPo, {id : req.body.id}, function(err, result){
            err ? ttUtils.doErr(res, err) : ttUtils.doInfo(res, null, result);
        });
    });
    app.post(curdUrl.list, function(req, res){
        gmClient.list(CurdPo, function(err, result){
            err ?  ttUtils.doErr(res, err) : ttUtils.doInfo(res, null, {rows : result, total : result.length});
        });
    });

};
